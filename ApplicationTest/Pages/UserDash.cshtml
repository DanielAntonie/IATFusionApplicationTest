@page
@model ApplicationTest.Pages.UserDashModel
@{
    Layout = null;
}

<style>
    .container {
        width: 600px;
        margin: 20px auto;
    }

    h3 {
        text-align: center;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    th,
    td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
    }

    th {
        background-color: #f0f0f0;
    }

</style>

<div class="container">
    <h3>User Dashboard</h3>

    @if (TempData["Message"] != null)
    {
        <div style="color: green; font-weight: bold;">@TempData["Message"]</div>
    }

    <form method="post" asp-page-handler="Logout" id="logoutForm">
        <button type="button" onclick="confirmLogout()">Logout</button>
    </form>

    <script>
        function confirmLogout()
        {
            if (confirm("Are you sure you want to log out?"))
            {
                document.getElementById("logoutForm").submit();
            }
        }
    </script>

    <!-- Course Application Form -->
    <form method="post">
        <label for="courseSelect">Select a course to apply:</label>
        <select id="courseSelect" asp-for="SelectedCourseId" name="SelectedCourseId">
            @foreach (System.Data.DataRow course in Model.AllCourses.Tables[0].Rows)
            {
                <option value="@course["Id"]">@course["Name"]</option>
            }
        </select>
        <button type="submit" asp-page-handler="Apply">Apply</button>
    </form>

    <h4>Your Courses</h4>
    @if (Model.UserCourses.Tables[0].Rows.Count > 0)
    {
        <table>
            <thead>
                <tr>
                    <th>Course Name</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow row in Model.UserCourses.Tables[0].Rows)
                {
                    <tr>
                        <td>@row["Name"]</td>
                        <td>
                            <form method="post" onsubmit="return confirm('Are you sure you want to delete this course?');">
                                <input type="hidden" name="courseId" value="@row["Id"]" />
                                <button type="submit" asp-page-handler="Delete">Delete</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>You have not applied for any courses yet.</p>
    }


</div>
